<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>eon-TREE</title>

   <!-- Import eon js  -->
   <script src="/eon/eon.js"></script>

   <!-- Example style -->
   <link rel="stylesheet"
        href="/example/ui/css/style.css">
   <link rel="stylesheet"
        href="/example/ui/css/tree.css">

   <!-- UI components -->
   <script>
     eon.import([
      "/eon/ui/eon-tree",
      "/eon/ui/eon-scroll",
      "/eon/ui/eon-button"
     ]);

   </script>

</head>

<body>
  <div class="container main">
    <div class="card">

      <h1>DECLARATIVE TREE</h1>

      <div class="example">

        <!-- TREE -->
        <eon-tree id="declarativeTree" icons="all">

          <eon-tree-node name="dir" path="dir"></eon-tree-node>
          <eon-tree-node type="file" name="file1" path="file1"></eon-tree-node>
          <eon-tree-node name="dir2" path="dir2"></eon-tree-node>
          <eon-tree-node path="dir2/dir2.1/dir2.1.1"></eon-tree-node>
          <eon-tree-node path="dir2/dir2.1/dir2.1.2"></eon-tree-node>
          <eon-tree-node type="file" path="dir2/dir2.1/dir2.1.1/dir2.1.1.1/file2"></eon-tree-node>
          <eon-tree-node name="dir2.1.2.1.1" path="dir2/dir2.1/dir2.1.2/dir2.1.2.1/dir2.1.2.1.1"></eon-tree-node>
          <eon-tree-node name="dir2.1.2.1.2" path="dir2/dir2.1/dir2.1.2/dir2.1.2.1/dir2.1.2.1.2"></eon-tree-node>
          <eon-tree-node type="file" extension="js" path="dir2/dir2.1/dir2.1.2/dir2.1.2.1/dir2.1.2.1.2/file3"></eon-tree-node>

        </eon-tree>

        <!-- ::::::: -->

      </div>

    </div>
    <div class="card">

      <h1>STORE BASED TREE</h1>

      <!-- <div id="progrmContainer" class="example"> -->

        <eon-tree id="store-tree" store="true" drag="true">
          
        </eon-tree>

      <!-- </div> -->

    </div>
  </div>
  
  <script type="text/javascript">

      var storeTree = document.querySelector("#store-tree");
      
      storeTree.onRender(function(){
        console.log('onReder');
        // ** New store
        var endpoint = new eon.endpoint("rest", "util/tree/data.json");

        // Get request
        endpoint.get("", function (success, data) {
            // Update store data & tree items
            storeTree.store.data = eon.util.objectToMap(JSON.parse(data.responseText));
        });   

        storeTree.onDataReady(function(){
          console.log('DATA READY');
          // eon.onReady(function(){
          
          // -- CREATE
          // :: events
          // Check store valid entry creation before manifest tree changes
          storeTree.onNodeCreate(function(node){
            console.log('Node create', node);
            // Memory tree, call tree function that creates store entry
            storeTree.create(node);
          });
          storeTree.onNodeCreated(function(nodeEl){
            console.log('Node created!', nodeEl);
            // :: Remove node!
            storeTree.removeNode(newNode.path);
          });

          var newNode = document.createElement("eon-tree-node");
          newNode.setAttribute("name", "dir6");
          newNode.path = "Juan";
          newNode.parent = "";
          // Create node
          storeTree.createNode(newNode.path);

          // -- REMOVE
          // :: events
          // Check store valid entry deletion before manifest tree changes
          storeTree.onNodeRemove(function(node){
            console.log('Node remove', node);
            // Memory tree, call tree function that removes the store entry
            storeTree.remove(node);
          });
          storeTree.onNodeRemoved(function(nodeEl){
            console.log('Node removed!', nodeEl);
          });
         
          // -- MOVE
          // :: events
          storeTree.onNodeMoved(function(nodeEl){
            console.log('Node removed!', nodeEl);
          });
          // -------------------------------


          var dTree = document.querySelector("#declarativeTree");
          var sTree = document.querySelector("#storeTree");
      
        });
      });
  </script>

</body>

</html>
