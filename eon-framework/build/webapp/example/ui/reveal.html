<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eon-REVEAL</title>

    <!-- Import VimletJS  -->
    <script src="/eon/eon.js"></script>

    <!-- Example style -->
    <link rel="stylesheet" href="/example/ui/css/style.css">
    <link rel="stylesheet" href="/example/ui/css/reveal.css">

    <!-- UI components -->
    <script>
        eon.import([
            "/eon/ui/eon-reveal",
            "/eon/ui/eon-stack"
        ]);
    </script>

</head>

<body>
    <div class="container main">
        <div class="card">
            <h1>STACK WHEEL REVEAL</h1>
            <div class="twoColumns ex-stack-container" style="flex-wrap: wrap;">
                <!-- SECTION MENU CONTROLLER -->
                <div class="ex-stack-menu">
                    <div onclick='document.querySelector("eon-stack").swapToPanel("1")'>
                        Section 1
                    </div>
                    <div onclick='document.querySelector("eon-stack").swapToPanel("2")'>
                        Section 2
                    </div>
                    <div onclick='document.querySelector("eon-stack").swapToPanel("3")'>
                        Section 3
                    </div>
                </div>
                <!-- END SECTION MENU CONTROLLER -->

                <!-- eon-STACK -->
                <eon-stack class="ex-stack">
                    <eon-panel name="1">
                        <eon-reveal class="ex-reveal ex-stack-reveal" end="150">
                            <div class="ex-item"></div>
                        </eon-reveal>
                    </eon-panel>
                    <eon-panel name="2">
                        <eon-reveal class="ex-reveal ex-stack-reveal" end="150">
                            <div class="ex-item ex-red"></div>
                        </eon-reveal>
                    </eon-panel>
                    <eon-panel name="3">
                        <eon-reveal class="ex-reveal ex-stack-reveal" end="150">
                                <div class="ex-item"></div>
                        </eon-reveal>
                    </eon-panel>
                </eon-stack>
                <!-- END eon-STACK -->

            </div>
        </div>
        <div class="card">
            <h1>REVEAL</h1>
            <div class="twoColumns" style="flex-wrap: wrap;">

                <!-- vc reveal -->
                <eon-reveal class="ex-reveal" end="15">
                    <div class="ex-item"></div>
                </eon-reveal>
               
                <!-- <eon-reveal class="ex-reveal" type="right">
                    <div class="ex-item ex-red"></div>
                </eon-reveal>
                <eon-reveal class="ex-reveal" type="top">
                    <div class="ex-item"></div>
                </eon-reveal>
                <eon-reveal class="ex-reveal" type="left">
                    <div class="ex-item ex-red"></div>
                </eon-reveal> -->

                 <div class="ex-reveal"></div>
                <div class="ex-reveal"></div>
                <div class="ex-reveal"></div>
                <div class="ex-reveal"></div>
                <div class="ex-reveal"></div>

            </div>
        </div>
    </div>
    <script>
        
        // Replay animation
        eon.onReady(function(){

            // STACK WHEEL REVEAL
            var stack = document.querySelector("eon-stack");
            var activeReveal;
            var idx = 0;
            var cancelWheelSwipe = false;

            // Trigger first panel reveal animation
            stack.getActivePanel().querySelector("eon-reveal").play();
            stack.onSwapped(function(prev, target){
                activeReveal = target.querySelector("eon-reveal");

                // On reveal animation ends
                activeReveal.onAnimationEnd(function(){
                    idx = parseInt(target.name) - 1;
                    console.log('onAnimationEnd ', target.name, idx);
                    cancelWheelSwipe = false;
                });

                activeReveal.play();
            });

            // Wheel functionality
            stack.addEventListener("wheel", function(){
                event.preventDefault();

                // Check if animation has ended
                if(!cancelWheelSwipe) {
                    if(event.deltaY > 0) {
                        // Wheel down
                        if(idx < (Object.keys(stack._misc.panels).length - 1)) {
                            console.log('down idx', idx);
                            cancelWheelSwipe = true;
                            stack._misc.panels[idx + 1].querySelector("eon-reveal").type = "bottom";
                            stack.swapToPanelByIndex(idx + 1);
                        }
                    } else {
                        // Wheel up
                        if(idx > 0) {
                            cancelWheelSwipe = true;
                            console.log('up idx', idx, stack._misc.panels[idx]);
                            // if(idx > 1) {
                                stack._misc.panels[idx].querySelector("eon-reveal").type = "top";
                            // } else {
                                console.log('PANEL', idx, stack._misc.panels);
                            // }
                            stack.swapToPanelByIndex(idx - 1);
                        }
                    }
                }

            });

            var rev = document.querySelector("eon-reveal");
            setTimeout(function() {
                // rev.play();
            }, 2000);
        });

    </script>
</body>
<html>