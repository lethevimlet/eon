<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>eon-TREE</title>

   <!-- Import eon js  -->
   <script src="/eon/eon.js"></script>

   <!-- Example style -->
   <link rel="stylesheet"
        href="/example/ui/css/style.css">
   <link rel="stylesheet"
        href="/example/ui/css/tree.css">

   <!-- UI components -->
   <script>
     eon.import([
      "/eon/ui/eon-tree",
      "/eon/ui/eon-scroll",
      "/eon/data/eon-store/eon-store.html",
      "/eon/ui/eon-button"
     ]);

   </script>

</head>

<body>
  <div class="container main">
    <div class="card">

      <h1>DECLARATIVE TREE</h1>

      <div class="example">

        <!-- TREE -->
        <eon-tree id="declarativeTree" icons="all">

          <eon-treenode name="dir" path="dir"></eon-treenode>
          <eon-treenode type="file" name="file1" path="file1"></eon-treenode>
          <eon-treenode name="dir2" path="dir2"></eon-treenode>
          <eon-treenode path="dir2/dir2.1/dir2.1.1"></eon-treenode>
          <eon-treenode path="dir2/dir2.1/dir2.1.2"></eon-treenode>
          <eon-treenode type="file" path="dir2/dir2.1/dir2.1.1/dir2.1.1.1/file2"></eon-treenode>
          <eon-treenode name="dir2.1.2.1.1" path="dir2/dir2.1/dir2.1.2/dir2.1.2.1/dir2.1.2.1.1"></eon-treenode>
          <eon-treenode name="dir2.1.2.1.2" path="dir2/dir2.1/dir2.1.2/dir2.1.2.1/dir2.1.2.1.2"></eon-treenode>
          <eon-treenode type="file" extension="js" path="dir2/dir2.1/dir2.1.2/dir2.1.2.1/dir2.1.2.1.2/file3"></eon-treenode>

        </eon-tree>

        <!-- ::::::: -->

      </div>

    </div>
    <div class="card">

      <h1>STORE BASED TREE</h1>

      <!-- <div id="progrmContainer" class="example"> -->

        <eon-tree id="store-tree" store="true">
          
        </eon-tree>

      <!-- </div> -->

    </div>
  </div>
  
  <script type="text/javascript">
    eon.onReady(function(){

      var storeTree = document.querySelector("#store-tree");

      // ** New store
      var endpoint = new eon.endpoint("rest", "util/tree/data.json");

      // Get request
      endpoint.get("", function (success, data) {
          // Update store data & tree items
          storeTree.store.data = eon.util.objectToMap(JSON.parse(data.responseText));
          // storeTree._refs.store.data = eon.util.arrayToMap(JSON.parse(data.responseText));
          console.log(":::: MAP", storeTree.store.data);
      });    

      var dTree = document.querySelector("#declarativeTree");
      var sTree = document.querySelector("#storeTree");
      
      // INTERPOLATION TEST
      // setTimeout(function() {
        //   document.querySelector("eon-treenode[path='dir/subdir/subdir2/subdir3']").data.name = "almondigas";
        // }, 2000);
        
        // var progrmContainer = document.querySelector("#progrmContainer");
        // var tree = document.createElement("eon-tree");
        // var fragment = document.createDocumentFragment();
        // var elm;
        // var paths = [
        //   "dir",
        //   "dir/subdir",
        //   "dir/subdir",
        //   "dir/subdir/file",
        //   "dir/subdir/subdir2/subdir3/subdir4/subdir5/subdir6/subdir7/subdir8/subdir9"
        // ];
        // for (var i = 0; i < paths.length; i++) {
          
        //   elm = document.createElement("eon-treenode");
        //   elm.path = paths[i];
        //   fragment.appendChild(elm);
          
        // }

        // tree.drag = true;
        // tree.appendChild(fragment);
        // progrmContainer.appendChild(tree);
        
        dTree.onReady(function(){
            var newNode = document.createElement("eon-treenode");
            newNode.setAttribute("name", "dir6");
            newNode.path = "Juan";
            newNode.parent = "";
          // dTree.createNode(newNode.path);
          setTimeout(function() {
            // dTree.refresh();
            // dTree.markNode(dTree.nodes["dir2"]);
            //   setTimeout(function() {
                // dTree.refresh("dir");
                // dTree.markNode(dTree.nodes["dir"]);
            // }, 1000);
          }, 1000);
       
        });
      });
  </script>

</body>

</html>
